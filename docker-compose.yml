version: '3'

services:
    nginx:
        build: ./nginx
        restart: always
        network_mode: "host"

    dev-frontend:
        image: node:8.0.0-alpine
        ports:
          - 8080:8080
        volumes:
          - ./frontend:/src
          - node_modules:/src/node_modules
        command: sh -c "cd src &&  npm install && npm run serve"

    dev-backend:
        image: golang:latest
        ports:
          - 3000:3001
        volumes:
          - ./backend:/src
        command: sh -c "cd /src && go get github.com/codegangsta/gin && gin -p 3001 -a 3000 -b ../gin-bin"

volumes:
    node_modules:
