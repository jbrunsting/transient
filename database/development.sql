CREATE EXTENSION pg_trgm;

CREATE TABLE IF NOT EXISTS Users (
    id VARCHAR(36) NOT NULL PRIMARY KEY,
    username VARCHAR(128) NOT NULL UNIQUE,
    password TEXT NOT NULL,
    email VARCHAR(254) NOT NULL UNIQUE
);

CREATE TABLE IF NOT EXISTS Followings (
    id VARCHAR(36) NOT NULL REFERENCES Users(id),
    followingId VARCHAR(36) NOT NULL REFERENCES Users(id),
    PRIMARY KEY (id, followingId)
);

CREATE TABLE IF NOT EXISTS Sessions (
    id VARCHAR(36) NOT NULL REFERENCES Users(id) ON DELETE CASCADE,
    sessionId VARCHAR(36) NOT NULL PRIMARY KEY,
    expiry TIMESTAMP NOT NULL
);

CREATE TABLE IF NOT EXISTS Posts (
    id VARCHAR(36) NOT NULL REFERENCES Users(id) ON DELETE CASCADE,
    postId VARCHAR(36) NOT NULL PRIMARY KEY,
    time TIMESTAMP NOT NULL,
    title TEXT NOT NULL,
    content TEXT,
    postUrl TEXT,
    imageUrl TEXT
);
